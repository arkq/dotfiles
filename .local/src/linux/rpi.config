# Kernel configuration for Raspberry Pi 3 and 4.
#
# Specification references:
# https://www.raspberrypi.com/products/raspberry-pi-4-model-b/specifications/

#
# General setup
#
CONFIG_LOCALVERSION_AUTO=y
CONFIG_DEFAULT_HOSTNAME="rpi"
CONFIG_SYSVIPC=y
CONFIG_POSIX_MQUEUE=y
CONFIG_NO_HZ_IDLE=y
CONFIG_HIGH_RES_TIMERS=y
CONFIG_IKCONFIG=y
CONFIG_IKCONFIG_PROC=y
CONFIG_CGROUPS=y
CONFIG_MEMCG=y
CONFIG_BLK_CGROUP=y
CONFIG_CGROUP_SCHED=y
CONFIG_CC_OPTIMIZE_FOR_PERFORMANCE=y
CONFIG_EXPERT=y
# CONFIG_SYSFS_SYSCALL is not set
# CONFIG_BUG is not set
# CONFIG_KALLSYMS is not set

#
# Platform selection
#
CONFIG_ARCH_BCM=y
CONFIG_ARCH_BCM2835=y

#
# Kernel Features
#
# XXX: Apply erratas for Cortex-A53 and Cortex-A72 only
# CONFIG_CAVIUM_ERRATUM_22375 is not set
# CONFIG_CAVIUM_ERRATUM_23154 is not set
# CONFIG_CAVIUM_ERRATUM_27456 is not set
# CONFIG_CAVIUM_ERRATUM_30115 is not set
CONFIG_NR_CPUS=4
CONFIG_HZ_100=y
# CONFIG_MITIGATE_SPECTRE_BRANCH_HISTORY is not set
# XXX: Disable everything above ARMv8.0
# CONFIG_ARM64_HW_AFDBM is not set
# CONFIG_ARM64_PAN is not set
# CONFIG_ARM64_USE_LSE_ATOMICS is not set
# CONFIG_ARM64_PMEM is not set
# CONFIG_ARM64_RAS_EXTN is not set
# CONFIG_ARM64_CNP is not set
# CONFIG_ARM64_PTR_AUTH is not set
# CONFIG_ARM64_AMU_EXTN is not set
# CONFIG_ARM64_TLB_RANGE is not set
# CONFIG_ARM64_BTI is not set
# CONFIG_ARM64_E0PD is not set
# CONFIG_ARM64_POE is not set
# CONFIG_ARM64_SVE is not set

#
# Boot options
#
# CONFIG_EFI is not set

#
# Power management options
#
# CONFIG_SUSPEND is not set
CONFIG_PM=y

#
# CPU Power Management
#
CONFIG_CPU_IDLE=y
CONFIG_CPU_FREQ=y
CONFIG_CPU_FREQ_DEFAULT_GOV_ONDEMAND=y
CONFIG_CPU_FREQ_GOV_ONDEMAND=y
CONFIG_CPUFREQ_DT=y

#
# General architecture-dependent options
#
CONFIG_JUMP_LABEL=y
# CONFIG_STACKPROTECTOR is not set
# CONFIG_VMAP_STACK is not set

#
# Enable loadable module support
#
CONFIG_MODULES=y
CONFIG_MODULE_UNLOAD=y

#
# Enable the block layer
#
CONFIG_PARTITION_ADVANCED=y
CONFIG_MSDOS_PARTITION=y
CONFIG_EFI_PARTITION=y

#
# Executable file formats
#
CONFIG_BINFMT_ELF=y
CONFIG_BINFMT_SCRIPT=y
CONFIG_BINFMT_MISC=y

#
# Networking support
#
CONFIG_NET=y

#
# Networking options
#
CONFIG_PACKET=y
CONFIG_UNIX=y
CONFIG_INET=y
CONFIG_IPV6=y
CONFIG_NETFILTER=y
CONFIG_BRIDGE=y

#
# Bluetooth subsystem support
#
CONFIG_BT=y
CONFIG_BT_BREDR=y
CONFIG_BT_RFCOMM=y
CONFIG_BT_RFCOMM_TTY=y
CONFIG_BT_BNEP=y
CONFIG_BT_HIDP=y
CONFIG_BT_LE=y
CONFIG_BT_LEDS=y
CONFIG_BT_HCIBTUSB=y
CONFIG_BT_HCIUART=y
CONFIG_BT_HCIUART_H4=y
CONFIG_BT_HCIUART_BCM=y
CONFIG_BT_HCIVHCI=y

#
# Wireless
#
CONFIG_WIRELESS=y
CONFIG_CFG80211=y

CONFIG_RFKILL=y

#
# Device Drivers
#

#
# PCI support
#
CONFIG_PCI=y
CONFIG_PCIEPORTBUS=y
CONFIG_PCI_DYNAMIC_OF_NODES=y
# CONFIG_VGA_ARB is not set
# XXX: Support for USB 3.0 on RPi4
CONFIG_PCIE_BRCMSTB=y

#
# Generic Driver Options
#
CONFIG_DEVTMPFS=y
CONFIG_DEVTMPFS_MOUNT=y
CONFIG_FW_LOADER=y

#
# Firmware Drivers
#
CONFIG_RASPBERRYPI_FIRMWARE=y

#
# Block devices
#
CONFIG_BLK_DEV=y
CONFIG_BLK_DEV_LOOP=y
CONFIG_BLK_DEV_LOOP_MIN_COUNT=4

#
# SCSI device support
#
CONFIG_SCSI=y
# CONFIG_SCSI_PROC_FS is not set
CONFIG_BLK_DEV_SD=y

#
# Network device support
#
CONFIG_NETDEVICES=y
CONFIG_NET_CORE=y
CONFIG_WIREGUARD=y
CONFIG_ETHERNET=y
# XXX: Support for ETH network on RPi4
CONFIG_BCMGENET=y
CONFIG_USB_USBNET=y
# CONFIG_USB_NET_AX8817X is not set
# CONFIG_USB_NET_AX88179_178A is not set
# CONFIG_USB_NET_CDCETHER is not set
# CONFIG_USB_NET_CDC_NCM is not set
# XXX: Support for ETH network on RPi3
CONFIG_USB_NET_SMSC95XX=y
# CONFIG_USB_NET_NET1080 is not set
# CONFIG_USB_NET_CDC_SUBSET is not set
# CONFIG_USB_NET_ZAURUS is not set
CONFIG_WLAN=y
CONFIG_BRCMFMAC=y

#
# Input device support
#
# CONFIG_INPUT_KEYBOARD is not set
# CONFIG_INPUT_MOUSE is not set
CONFIG_INPUT_MISC=y
CONFIG_INPUT_UINPUT=y

#
# Character devices
#
CONFIG_BRCM_CHAR_DRIVERS=y
CONFIG_TTY=y
CONFIG_VT=y
# CONFIG_LEGACY_PTYS is not set
CONFIG_SERIAL_8250=y
CONFIG_SERIAL_8250_CONSOLE=y
# CONFIG_SERIAL_8250_DMA is not set
CONFIG_SERIAL_8250_NR_UARTS=5
CONFIG_SERIAL_8250_RUNTIME_UARTS=0
CONFIG_SERIAL_8250_EXTENDED=y
CONFIG_SERIAL_8250_SHARE_IRQ=y
CONFIG_SERIAL_8250_BCM2835AUX=y
CONFIG_SERIAL_OF_PLATFORM=y
CONFIG_SERIAL_AMBA_PL011=y
CONFIG_SERIAL_AMBA_PL011_CONSOLE=y
CONFIG_SERIAL_DEV_BUS=y
CONFIG_TTY_PRINTK=y
CONFIG_HW_RANDOM=y
CONFIG_HW_RANDOM_BCM2835=y
CONFIG_RASPBERRYPI_GPIOMEM=y

#
# I2C support
#
CONFIG_I2C=y
CONFIG_I2C_BCM2835=y

#
# SPI support
#
CONFIG_SPI=y
CONFIG_SPI_BCM2835=y
CONFIG_SPI_BCM2835AUX=y

#
# Hardware Monitoring support
#
CONFIG_HWMON=y
CONFIG_SENSORS_RASPBERRYPI_HWMON=y

#
# Thermal drivers
#
CONFIG_THERMAL=y
CONFIG_BCM2711_THERMAL=y
CONFIG_BCM2835_THERMAL=y

#
# Watchdog Timer Support
#
CONFIG_WATCHDOG=y
CONFIG_WATCHDOG_SYSFS=y
CONFIG_BCM2835_WDT=y

#
# Multifunction device drivers
#
CONFIG_MFD_SYSCON=y

#
# Voltage and Current Regulator Support
#
CONFIG_REGULATOR=y
CONFIG_REGULATOR_FIXED_VOLTAGE=y
CONFIG_REGULATOR_GPIO=y

#
# GPIO Support
#
CONFIG_GPIOLIB=y
CONFIG_GPIO_SYSFS=y
CONFIG_GPIO_BCM_VIRT=y

#
# Multimedia support
#
CONFIG_MEDIA_SUPPORT=y
CONFIG_VIDEO_RPI_HEVC_DEC=y

#
# Graphics support
#
CONFIG_DRM=y

#
# Sound card support
#
CONFIG_SOUND=y
CONFIG_SND=y
# CONFIG_SND_SUPPORT_OLD_API is not set
CONFIG_SND_SEQUENCER=y
CONFIG_SND_ALOOP=y
# XXX: Support for external sound cards
CONFIG_SND_USB=y
CONFIG_SND_USB_AUDIO=y
CONFIG_SND_SOC=y
CONFIG_SND_BCM2835_SOC_I2S=y

#
# USB support
#
CONFIG_USB=y
CONFIG_USB_ANNOUNCE_NEW_DEVICES=y
CONFIG_USB_MON=y
CONFIG_USB_XHCI_HCD=y
CONFIG_USB_DWCOTG=y
CONFIG_USB_STORAGE=y
CONFIG_USB_DWC3=y
CONFIG_USB_SERIAL=y
CONFIG_NOP_USB_XCEIV=y

#
# MMC/SD/SDIO card support
#
CONFIG_MMC=y
CONFIG_MMC_BCM2835_MMC=y
CONFIG_MMC_BCM2835_DMA=y
# XXX: Support for MMC controller on RPi4
CONFIG_MMC_SDHCI=y
CONFIG_MMC_SDHCI_PLTFM=y
CONFIG_MMC_SDHCI_OF_DWCMSHC=y
CONFIG_MMC_SDHCI_IPROC=y
CONFIG_MMC_HSQ=y
CONFIG_MMC_BCM2835=y

#
# LED Support
#
CONFIG_NEW_LEDS=y
CONFIG_LEDS_CLASS=y
CONFIG_LEDS_GPIO=y
CONFIG_LEDS_TRIGGER_TIMER=y
CONFIG_LEDS_TRIGGER_ONESHOT=y
CONFIG_LEDS_TRIGGER_HEARTBEAT=y
CONFIG_LEDS_TRIGGER_INPUT=y

#
# DMA Engine support
#
CONFIG_DMADEVICES=y
CONFIG_DMA_BCM2835=y

#
# Staging drivers
#
CONFIG_STAGING=y
CONFIG_STAGING_MEDIA=y
CONFIG_BCM_VIDEOCORE=y
CONFIG_BCM2835_VCHIQ=y
CONFIG_SND_BCM2835=y

#
# Common Clock Framework
#
CONFIG_COMMON_CLK=y
CONFIG_CLK_RASPBERRYPI=y

#
# Mailbox Hardware Support
#
CONFIG_MAILBOX=y
CONFIG_BCM2835_MBOX=y

#
# PM Domains
#
CONFIG_BCM2835_POWER=y
CONFIG_RASPBERRYPI_POWER=y

#
# Pulse-Width Modulation (PWM) Support
#
CONFIG_PWM=y
CONFIG_PWM_BCM2835=y

#
# File systems
#

CONFIG_EXT4_FS=y
CONFIG_EXT4_FS_POSIX_ACL=y
CONFIG_EXT4_FS_SECURITY=y
CONFIG_FANOTIFY=y
CONFIG_AUTOFS_FS=y
CONFIG_FUSE_FS=y
CONFIG_OVERLAY_FS=y
CONFIG_OVERLAY_FS_REDIRECT_DIR=y
CONFIG_OVERLAY_FS_INDEX=y
CONFIG_OVERLAY_FS_XINO_AUTO=y
CONFIG_OVERLAY_FS_METACOPY=y

#
# DOS/FAT/NT Filesystems
#
CONFIG_MSDOS_FS=y
CONFIG_VFAT_FS=y
CONFIG_FAT_DEFAULT_CODEPAGE=437
CONFIG_FAT_DEFAULT_IOCHARSET="iso8859-1"

#
# Pseudo filesystems
#
CONFIG_PROC_FS=y
CONFIG_TMPFS=y
CONFIG_TMPFS_POSIX_ACL=y
CONFIG_TMPFS_INODE64=y
CONFIG_CONFIGFS_FS=y

#
# Native language support
#
CONFIG_NLS=y
CONFIG_NLS_DEFAULT="utf8"
CONFIG_NLS_CODEPAGE_437=y
CONFIG_NLS_ISO8859_1=y
CONFIG_NLS_UTF8=y

#
# Cryptographic API
#
CONFIG_CRYPTO=y
CONFIG_CRYPTO_SHA256_ARM64=y
CONFIG_CRYPTO_SHA512_ARM64=y
CONFIG_CRYPTO_AES_ARM64=y
CONFIG_CRYPTO_AES_ARM64_BS=y
CONFIG_CRYPTO_AES_ARM64_NEON_BLK=y

#
# Kernel hacking
#
CONFIG_PRINTK_TIME=y
CONFIG_DYNAMIC_DEBUG=y
